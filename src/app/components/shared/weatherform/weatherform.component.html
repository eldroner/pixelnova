<h2>Consulta del Tiempo</h2>

<form (ngSubmit)="onSubmit()">
  <!-- ðŸ”¹ Input con funcionalidad de autocompletado -->
  <div class="mb-3">
    <label for="municipio" class="form-label">Selecciona un municipio:</label>
    
    <input 
      type="text" 
      id="municipio"
      class="form-control"
      placeholder="Escribe el nombre del municipio..."
      (input)="filtrarMunicipios($event)"
      [(ngModel)]="municipioNombre" 
      name="municipio"
      required
      autocomplete="off"
    />

    <!-- ðŸ”¹ Lista de sugerencias -->
    <ul class="list-group mt-2" *ngIf="municipiosFiltrados.length > 0">
      <li 
        class="list-group-item list-group-item-action"
        *ngFor="let municipio of municipiosFiltrados"
        (click)="seleccionarMunicipio(municipio)">
        {{ municipio.nombre }}
      </li>
    </ul>
  </div>

  <!-- ðŸ”¹ Selector de fecha -->
  <div class="mb-3">
    <label for="fecha" class="form-label">Selecciona un dÃ­a:</label>
    <input 
      id="fecha" 
      type="date" 
      class="form-control" 
      [(ngModel)]="fecha" 
      name="fecha"
      required
    />
  </div>

  <button type="submit" class="btn btn-primary">Consultar</button>
</form>

<!-- ðŸ”¹ Mostrar resultados -->
<div *ngIf="filteredWeatherData && filteredWeatherData.length > 0" class="mt-4">
  <h3>PronÃ³stico del tiempo para {{ municipioSeleccionado?.nombre }} el {{ fecha }}:</h3>
  <table class="table table-striped table-bordered">
    <thead>
      <tr>
        <th>Temperatura MÃ¡xima</th>
        <th>Temperatura MÃ­nima</th>
        <th>Probabilidad de Lluvia</th>
        <th>Estado del Cielo</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let item of filteredWeatherData">
        <td>{{ item.temperatura?.maxima ?? 'N/A' }}Â°C</td>
        <td>{{ item.temperatura?.minima ?? 'N/A' }}Â°C</td>
        <td>{{ item.probPrecipitacion?.[0]?.value ?? 'N/A' }}%</td>
        <td>{{ item.estadoCielo?.[0]?.descripcion ?? 'N/A' }}</td>
      </tr>
    </tbody>
  </table>
</div>
